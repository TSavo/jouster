<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Reference - Jouster Documentation</title>
  
  <!-- CSS files -->
  <link rel="stylesheet" href="./assets/css/search.css">
  <link rel="stylesheet" href="./assets/css/collapsible.css">
  <link rel="stylesheet" href="./assets/css/code-highlight.css">
  <link rel="stylesheet" href="./assets/css/interactive-demos.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- JavaScript files -->
  <script src="./assets/js/search-index.js" defer></script>
  <script src="./assets/js/search-core.js" defer></script>
  <script src="./assets/js/search-ui.js" defer></script>
  <script src="./assets/js/collapsible.js" defer></script>
  <script src="./assets/js/code-highlight.js" defer></script>
  <script src="./assets/js/interactive-demos.js" defer></script>
  <script src="./assets/js/main.js" defer></script>
  
  <style>
    /* Basic styles */
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      line-height: 1.6;
      color: #24292e;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .wrapper {
      display: flex;
    }
    
    .sidebar {
      width: 260px;
      padding: 20px;
      border-right: 1px solid #e1e4e8;
    }
    
    .main-content {
      flex: 1;
      padding: 20px 40px;
    }
    
    h1, h2, h3, h4, h5, h6 {
      color: #0366d6;
      margin-top: 24px;
      margin-bottom: 16px;
    }
    
    a {
      color: #0366d6;
      text-decoration: none;
    }
    
    a:hover {
      text-decoration: underline;
    }
    
    .logo {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .logo img {
      width: 40px;
      height: 40px;
      margin-right: 10px;
    }
    
    .logo h1 {
      margin: 0;
      font-size: 24px;
    }
    
    .nav-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    
    .nav-list li {
      margin-bottom: 8px;
    }
    
    .nav-section {
      margin-bottom: 20px;
    }
    
    .nav-section-title {
      font-weight: 600;
      margin-bottom: 10px;
      color: #0366d6;
    }
    
    .nav-subsection {
      padding-left: 15px;
    }
    
    /* Enhanced badge */
    .enhanced-badge {
      display: inline-block;
      background-color: #2ea44f;
      color: white;
      font-size: 12px;
      font-weight: bold;
      padding: 2px 6px;
      border-radius: 12px;
      margin-left: 8px;
      vertical-align: middle;
    }
    
    /* Dark mode styles */
    body.dark-mode {
      background-color: #0d1117;
      color: #c9d1d9;
    }
    
    body.dark-mode h1, 
    body.dark-mode h2, 
    body.dark-mode h3, 
    body.dark-mode h4, 
    body.dark-mode h5, 
    body.dark-mode h6 {
      color: #58a6ff;
    }
    
    body.dark-mode a {
      color: #58a6ff;
    }
    
    body.dark-mode .sidebar {
      border-right-color: #30363d;
    }
    
    /* Responsive design */
    @media (max-width: 768px) {
      .wrapper {
        flex-direction: column;
      }
      
      .sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #e1e4e8;
      }
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <aside class="sidebar">
      <div class="logo">
        <img src="./assets/images/logo.svg" alt="Jouster Logo">
        <h1>Jouster</h1>
      </div>
      
      <div class="search-container">
        <input type="text" id="search-input" class="search-input" placeholder="Search documentation...">
        <div id="search-results" class="search-results"></div>
      </div>
      
      <div class="dark-mode-container">
        <span class="dark-mode-label">Dark Mode</span>
        <label class="dark-mode-toggle">
          <input type="checkbox" id="dark-mode-toggle">
          <span class="dark-mode-slider"></span>
        </label>
      </div>
      
      <nav>
        <div class="nav-section">
          <div class="nav-section-title">Getting Started</div>
          <ul class="nav-list">
            <li><a href="./main.html">Introduction</a></li>
            <li><a href="./getting-started-enhanced.html">Installation</a> <span class="enhanced-badge">Enhanced</span></li>
            <li><a href="./setup-wizard.html">Setup Wizard</a> <span class="enhanced-badge">Enhanced</span></li>
            <li><a href="./usage-guide.html">Usage Guide</a> <span class="enhanced-badge">Enhanced</span></li>
          </ul>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Test Runners</div>
          <ul class="nav-list">
            <li><a href="./test-runners-enhanced.html">Overview</a> <span class="enhanced-badge">Enhanced</span></li>
            <li class="nav-subsection">
              <ul class="nav-list">
                <li><a href="./test-runners/jest-enhanced.html">Jest</a> <span class="enhanced-badge">Enhanced</span></li>
                <li><a href="./test-runners/mocha-enhanced.html">Mocha</a> <span class="enhanced-badge">Enhanced</span></li>
                <li><a href="./test-runners/ava.html">AVA</a></li>
                <li><a href="./test-runners/tape.html">Tape</a></li>
                <li><a href="./test-runners/jasmine.html">Jasmine</a></li>
                <li><a href="./test-runners/vitest.html">Vitest</a></li>
                <li><a href="./test-runners/cypress.html">Cypress</a></li>
                <li><a href="./test-runners/playwright.html">Playwright</a></li>
                <li><a href="./test-runners/testcafe.html">TestCafe</a></li>
                <li><a href="./test-runners/karma.html">Karma</a></li>
                <li><a href="./test-runners/generic.html">Generic</a></li>
              </ul>
            </li>
          </ul>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Core Concepts</div>
          <ul class="nav-list">
            <li><a href="./core-concepts.html">How Jouster Works</a></li>
            <li><a href="./core-concepts.html#test-identification">Test Identification</a></li>
            <li><a href="./core-concepts.html#issue-lifecycle">Issue Lifecycle</a></li>
            <li><a href="./core-concepts.html#mapping-database">Mapping Database</a></li>
          </ul>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Advanced Features</div>
          <ul class="nav-list">
            <li><a href="./advanced-features.html">Overview</a></li>
            <li><a href="./templates.html">Templates</a></li>
            <li><a href="./advanced-features.html#hooks">Hooks</a></li>
            <li><a href="./advanced-features.html#plugins">Plugins</a></li>
          </ul>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Resources</div>
          <ul class="nav-list">
            <li><a href="./api-reference.html">API Reference</a></li>
            <li><a href="./troubleshooting.html">Troubleshooting</a></li>
            <li><a href="./contributing.html">Contributing</a></li>
            <li><a href="./examples/README.html">Examples</a></li>
          </ul>
        </div>
      </nav>
    </aside>
    
    <main class="main-content">
      <h1>API Reference</h1>
      
      <p>This page provides a comprehensive reference for Jouster's API. You can use this API to integrate Jouster with your own tools or to extend its functionality.</p>
      
      <h2 class="collapsible-header">Command Line Interface</h2>
      <div class="collapsible-content">
        <p>Jouster provides a command-line interface (CLI) that you can use to run tests, manage issues, and configure the tool.</p>
        
        <h3>Commands</h3>
        <ul>
          <li><code>run-tests</code>: Run tests and manage issues for failing tests.</li>
          <li><code>list-issues</code>: List all issues in the mapping database.</li>
          <li><code>clean-database</code>: Remove entries for tests that no longer exist.</li>
          <li><code>init</code>: Initialize Jouster in a project.</li>
          <li><code>setup</code>: Run the setup wizard.</li>
          <li><code>version</code>: Show the version of Jouster.</li>
          <li><code>help</code>: Show help for a command.</li>
        </ul>
        
        <h3>Options</h3>
        <p>Each command supports various options that you can use to customize its behavior. Here are some common options:</p>
        
        <h4>Global Options</h4>
        <ul>
          <li><code>--config</code>: Path to the configuration file.</li>
          <li><code>--verbose</code>: Enable verbose output.</li>
          <li><code>--quiet</code>: Disable output.</li>
          <li><code>--help</code>: Show help for a command.</li>
        </ul>
        
        <h4>run-tests Options</h4>
        <ul>
          <li><code>--test-runner</code>: The test runner to use (jest, mocha, etc.).</li>
          <li><code>--tracker-type</code>: The issue tracker to use (github, file, etc.).</li>
          <li><code>--github-owner</code>: The owner of the GitHub repository.</li>
          <li><code>--github-repo</code>: The name of the GitHub repository.</li>
          <li><code>--github-token</code>: The GitHub token to use for authentication.</li>
          <li><code>--mapping-file</code>: The path to the mapping file.</li>
          <li><code>--template-open</code>: The path to the template for opening issues.</li>
          <li><code>--template-close</code>: The path to the template for closing issues.</li>
          <li><code>--template-reopen</code>: The path to the template for reopening issues.</li>
        </ul>
        
        <h4>list-issues Options</h4>
        <ul>
          <li><code>--mapping-file</code>: The path to the mapping file.</li>
          <li><code>--format</code>: The format to use for the output (json, table, etc.).</li>
        </ul>
        
        <h4>clean-database Options</h4>
        <ul>
          <li><code>--mapping-file</code>: The path to the mapping file.</li>
          <li><code>--dry-run</code>: Show what would be removed without actually removing it.</li>
        </ul>
      </div>
      
      <h2 class="collapsible-header">JavaScript API</h2>
      <div class="collapsible-content">
        <p>Jouster provides a JavaScript API that you can use to integrate it with your own tools or to extend its functionality.</p>
        
        <h3>Jouster Class</h3>
        <p>The <code>Jouster</code> class is the main entry point for the JavaScript API. It provides methods for running tests, managing issues, and configuring the tool.</p>
        
        <pre><code class="language-javascript">const { Jouster } = require('jouster');

// Create a new Jouster instance
const jouster = new Jouster({
  testRunnerType: 'jest',
  issueManager: 'github',
  github: {
    owner: 'TSavo',
    repo: 'jouster',
    token: process.env.GITHUB_TOKEN
  }
});

// Run tests and manage issues
jouster.runTests()
  .then(() => {
    console.log('Tests completed');
  })
  .catch((error) => {
    console.error('Error running tests:', error);
  });</code></pre>
        
        <h3>Methods</h3>
        <ul>
          <li><code>runTests(options)</code>: Run tests and manage issues for failing tests.</li>
          <li><code>listIssues(options)</code>: List all issues in the mapping database.</li>
          <li><code>cleanDatabase(options)</code>: Remove entries for tests that no longer exist.</li>
          <li><code>addTestRunner(name, testRunner)</code>: Add a custom test runner.</li>
          <li><code>addIssueManager(name, issueManager)</code>: Add a custom issue manager.</li>
          <li><code>addHook(name, hook)</code>: Add a custom hook.</li>
          <li><code>addCommand(name, command)</code>: Add a custom command.</li>
        </ul>
        
        <h3>Events</h3>
        <p>The <code>Jouster</code> class extends <code>EventEmitter</code>, so you can listen for events using the <code>on</code> method:</p>
        
        <pre><code class="language-javascript">jouster.on('testRunStart', () => {
  console.log('Test run started');
});

jouster.on('testRunComplete', (results) => {
  console.log('Test run completed:', results);
});

jouster.on('issueCreated', (issue) => {
  console.log('Issue created:', issue);
});

jouster.on('issueClosed', (issue) => {
  console.log('Issue closed:', issue);
});

jouster.on('issueReopened', (issue) => {
  console.log('Issue reopened:', issue);
});</code></pre>
      </div>
      
      <h2 class="collapsible-header">Test Runner API</h2>
      <div class="collapsible-content">
        <p>The Test Runner API allows you to create custom test runners for Jouster. A test runner is responsible for running tests and parsing the results.</p>
        
        <h3>Test Runner Interface</h3>
        <p>A test runner must implement the following interface:</p>
        
        <pre><code class="language-javascript">interface TestRunner {
  run(options: any): Promise<any>;
  parseResults(results: any): TestResults;
  generateTestId(test: Test): string;
}</code></pre>
        
        <h3>Methods</h3>
        <ul>
          <li><code>run(options)</code>: Run the tests and return the results.</li>
          <li><code>parseResults(results)</code>: Parse the test results into a standard format.</li>
          <li><code>generateTestId(test)</code>: Generate a unique identifier for a test.</li>
        </ul>
        
        <h3>Example</h3>
        <pre><code class="language-javascript">// custom-test-runner.js
module.exports = {
  run: async function(options) {
    // Run the tests and return the results
    const { spawn } = require('child_process');
    const child = spawn('custom-test-runner', ['--reporter', 'json']);
    
    let stdout = '';
    child.stdout.on('data', (data) => {
      stdout += data.toString();
    });
    
    return new Promise((resolve, reject) => {
      child.on('close', (code) => {
        if (code === 0) {
          resolve(stdout);
        } else {
          reject(new Error(`Test runner exited with code ${code}`));
        }
      });
    });
  },
  
  parseResults: function(results) {
    // Parse the results into a standard format
    const parsedResults = JSON.parse(results);
    
    return {
      passed: parsedResults.passed,
      failed: parsedResults.failed,
      tests: parsedResults.tests.map((test) => ({
        name: test.name,
        file: test.file,
        status: test.status,
        error: test.error
      }))
    };
  },
  
  generateTestId: function(test) {
    // Generate a unique identifier for the test
    return `${test.file}:${test.name}`;
  }
};</code></pre>
      </div>
      
      <h2 class="collapsible-header">Issue Manager API</h2>
      <div class="collapsible-content">
        <p>The Issue Manager API allows you to create custom issue managers for Jouster. An issue manager is responsible for creating, updating, and closing issues in a bug tracking system.</p>
        
        <h3>Issue Manager Interface</h3>
        <p>An issue manager must implement the following interface:</p>
        
        <pre><code class="language-javascript">interface IssueManager {
  createIssue(issue: Issue, options: any): Promise<IssueResult>;
  closeIssue(issueId: string, options: any): Promise<void>;
  reopenIssue(issueId: string, options: any): Promise<void>;
  getIssue(issueId: string, options: any): Promise<Issue>;
}</code></pre>
        
        <h3>Methods</h3>
        <ul>
          <li><code>createIssue(issue, options)</code>: Create a new issue in the bug tracking system.</li>
          <li><code>closeIssue(issueId, options)</code>: Close an issue in the bug tracking system.</li>
          <li><code>reopenIssue(issueId, options)</code>: Reopen a closed issue in the bug tracking system.</li>
          <li><code>getIssue(issueId, options)</code>: Get information about an issue in the bug tracking system.</li>
        </ul>
        
        <h3>Example</h3>
        <pre><code class="language-javascript">// custom-issue-manager.js
module.exports = {
  createIssue: async function(issue, options) {
    // Create a new issue in the bug tracking system
    const response = await fetch('https://api.example.com/issues', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${options.token}`
      },
      body: JSON.stringify({
        title: issue.title,
        body: issue.body,
        labels: issue.labels
      })
    });
    
    const data = await response.json();
    
    return {
      id: data.id,
      url: data.url
    };
  },
  
  closeIssue: async function(issueId, options) {
    // Close an issue in the bug tracking system
    await fetch(`https://api.example.com/issues/${issueId}`, {
      method: 'PATCH',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${options.token}`
      },
      body: JSON.stringify({
        state: 'closed'
      })
    });
  },
  
  reopenIssue: async function(issueId, options) {
    // Reopen a closed issue in the bug tracking system
    await fetch(`https://api.example.com/issues/${issueId}`, {
      method: 'PATCH',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${options.token}`
      },
      body: JSON.stringify({
        state: 'open'
      })
    });
  },
  
  getIssue: async function(issueId, options) {
    // Get information about an issue in the bug tracking system
    const response = await fetch(`https://api.example.com/issues/${issueId}`, {
      headers: {
        'Authorization': `Bearer ${options.token}`
      }
    });
    
    const data = await response.json();
    
    return {
      id: data.id,
      title: data.title,
      body: data.body,
      state: data.state,
      url: data.url
    };
  }
};</code></pre>
      </div>
      
      <h2 class="collapsible-header">Hook API</h2>
      <div class="collapsible-content">
        <p>The Hook API allows you to create custom hooks for Jouster. Hooks are functions that are called at specific points in Jouster's execution.</p>
        
        <h3>Hook Interface</h3>
        <p>A hook is a function that receives a context object and returns a promise:</p>
        
        <pre><code class="language-javascript">type Hook = (context: any) => Promise<void>;</code></pre>
        
        <h3>Available Hooks</h3>
        <ul>
          <li><code>beforeRun</code>: Called before running tests.</li>
          <li><code>afterRun</code>: Called after running tests.</li>
          <li><code>beforeIssueCreate</code>: Called before creating an issue.</li>
          <li><code>afterIssueCreate</code>: Called after creating an issue.</li>
          <li><code>beforeIssueClose</code>: Called before closing an issue.</li>
          <li><code>afterIssueClose</code>: Called after closing an issue.</li>
          <li><code>beforeIssueReopen</code>: Called before reopening an issue.</li>
          <li><code>afterIssueReopen</code>: Called after reopening an issue.</li>
        </ul>
        
        <h3>Example</h3>
        <pre><code class="language-javascript">// hooks/before-run.js
module.exports = function(context) {
  console.log('Running tests with Jouster...');
  console.log('Test runner:', context.config.testRunnerType);
  console.log('Issue manager:', context.config.issueManager);
  
  // You can modify the context object to affect Jouster's behavior
  context.config.testRunnerOptions.jest.bail = true;
  
  // You can also return a promise to perform asynchronous operations
  return Promise.resolve();
};</code></pre>
      </div>
      
      <h2 class="collapsible-header">Plugin API</h2>
      <div class="collapsible-content">
        <p>The Plugin API allows you to create custom plugins for Jouster. Plugins are modules that can extend Jouster's functionality by adding new test runners, issue managers, hooks, or commands.</p>
        
        <h3>Plugin Interface</h3>
        <p>A plugin is a function that receives a Jouster instance:</p>
        
        <pre><code class="language-javascript">type Plugin = (jouster: Jouster) => void;</code></pre>
        
        <h3>Example</h3>
        <pre><code class="language-javascript">// plugins/custom-plugin.js
module.exports = function(jouster) {
  // Add a new test runner
  jouster.addTestRunner('custom', require('./custom-test-runner'));
  
  // Add a new issue manager
  jouster.addIssueManager('custom', require('./custom-issue-manager'));
  
  // Add a new hook
  jouster.addHook('customHook', require('./custom-hook'));
  
  // Add a new command
  jouster.addCommand('custom-command', require('./custom-command'));
};</code></pre>
      </div>
      
      <h2 class="collapsible-header">Template API</h2>
      <div class="collapsible-content">
        <p>The Template API allows you to create custom templates for Jouster. Templates are used to generate the content of issues.</p>
        
        <h3>Template Variables</h3>
        <p>Templates can include variables that are replaced with actual values when the template is rendered. Variables are enclosed in double curly braces (<code>{{variable}}</code>).</p>
        
        <h4>Test Variables</h4>
        <ul>
          <li><code>{{test.name}}</code>: The name of the test.</li>
          <li><code>{{test.file}}</code>: The file containing the test.</li>
          <li><code>{{test.line}}</code>: The line number of the test.</li>
          <li><code>{{test.column}}</code>: The column number of the test.</li>
          <li><code>{{test.error}}</code>: The error message from the test failure.</li>
          <li><code>{{test.stackTrace}}</code>: The stack trace from the test failure.</li>
          <li><code>{{test.duration}}</code>: The duration of the test in milliseconds.</li>
        </ul>
        
        <h4>Test Runner Variables</h4>
        <ul>
          <li><code>{{testRunner.type}}</code>: The type of test runner (Jest, Mocha, etc.).</li>
          <li><code>{{testRunner.version}}</code>: The version of the test runner.</li>
          <li><code>{{testRunner.command}}</code>: The command used to run the tests.</li>
        </ul>
        
        <h4>System Variables</h4>
        <ul>
          <li><code>{{system.os}}</code>: The operating system.</li>
          <li><code>{{system.nodeVersion}}</code>: The version of Node.js.</li>
          <li><code>{{system.jousterVersion}}</code>: The version of Jouster.</li>
          <li><code>{{system.date}}</code>: The current date and time.</li>
          <li><code>{{system.user}}</code>: The current user.</li>
        </ul>
        
        <h4>Issue Variables</h4>
        <ul>
          <li><code>{{issue.id}}</code>: The ID of the issue.</li>
          <li><code>{{issue.url}}</code>: The URL of the issue.</li>
          <li><code>{{issue.title}}</code>: The title of the issue.</li>
          <li><code>{{issue.body}}</code>: The body of the issue.</li>
          <li><code>{{issue.state}}</code>: The state of the issue (open, closed, etc.).</li>
          <li><code>{{issue.labels}}</code>: The labels of the issue.</li>
          <li><code>{{issue.assignee}}</code>: The assignee of the issue.</li>
          <li><code>{{issue.createdAt}}</code>: The creation date of the issue.</li>
          <li><code>{{issue.updatedAt}}</code>: The last update date of the issue.</li>
        </ul>
        
        <h3>Template Helpers</h3>
        <p>Jouster provides several helpers that can be used in templates to format data or perform operations.</p>
        
        <h4>Conditional Helpers</h4>
        <pre><code class="language-markdown">{{#if test.error}}
## Error
```
{{test.error}}
```
{{/if}}

{{#unless test.error}}
No error was reported.
{{/unless}}</code></pre>
        
        <h4>Iteration Helpers</h4>
        <pre><code class="language-markdown">## Labels
{{#each issue.labels}}
- {{this}}
{{/each}}</code></pre>
        
        <h4>Formatting Helpers</h4>
        <pre><code class="language-markdown">## Created At
{{formatDate issue.createdAt "YYYY-MM-DD HH:mm:ss"}}

## Duration
{{formatDuration test.duration}}

## Stack Trace
{{formatStackTrace test.stackTrace}}</code></pre>
      </div>
      
      <footer>
        <p>Jouster Documentation - <a href="https://github.com/TSavo/jouster">GitHub Repository</a></p>
      </footer>
    </main>
  </div>
</body>
</html>
